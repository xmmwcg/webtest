/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jun 7 13:52
*/
KISSY.add("event/custom/api",function(){return{}});KISSY.add("event/custom/observer",function(b,j){function c(){c.superclass.constructor.apply(this,arguments)}b.extend(c,j._Observer,{keys:["fn","context","groups"]});return c},{requires:["event/base"]});KISSY.add("event/custom/object",function(b,j){function c(f){c.superclass.constructor.call(this);b.mix(this,f)}b.extend(c,j._Object);return c},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(b,j,c,f,g){function h(){h.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var d=g._Utils;b.extend(h,g._ObservableEvent,{constructor:h,on:function(a){a=new c(a);-1==this.findObserver(a)&&this.observers.push(a)},fire:function(a){var a=a||{},k=this.bubbles,n=this.currentTarget,e,d=this.type,l=this.defaultFn,m,i=a,b;a.type=d;i instanceof f||(i.target=n,i=new f(i));i.currentTarget=n;a=this.notify(i);
!1!==b&&(b=a);if(k&&!i.isPropagationStopped()){e=(k=j.getTargets(n,1))&&k.length||0;for(m=0;m<e&&!i.isPropagationStopped();m++)a=j.fire(k[m],d,i),!1!==b&&(b=a)}if(l&&!i.isDefaultPrevented()&&(d=h.getCustomEvent(i.target,i.type),!this.defaultTargetOnly&&!d.defaultTargetOnly||n==i.target))b=l.call(n,i);return b},notify:function(a){var k=[].concat(this.observers),d,e,b=k.length,l;for(l=0;l<b&&!a.isImmediatePropagationStopped();l++)d=k[l].notify(a,this),!1!==e&&(e=d),!1===d&&a.halt();return e},detach:function(a){var k,
b=a.fn,e=a.context,c=this.currentTarget,l=this.observers,a=a.groups;if(l.length){a&&(k=d.getGroupsRe(a));var m,i,f,g,h=l.length;if(b||k){e=e||c;m=a=0;for(i=[];a<h;++a)if(f=l[a],g=f.context||c,e!=g||b&&b!=f.fn||k&&!f.groups.match(k))i[m++]=f;this.observers=i}else this.reset()}}});h.getCustomEvent=function(a,d,b){var e,c=h.getCustomEvents(a,b);e=c&&c[d];!e&&b&&(e=c[d]=new h({currentTarget:a,type:d}));return e};h.getCustomEvents=function(a,d){!a["__~ks_custom_events"]&&d&&(a["__~ks_custom_events"]={});
return a["__~ks_custom_events"]};return h},{requires:["./api","./observer","./object","event/base"]});
KISSY.add("event/custom/api-impl",function(b,j,c,f){var g=c._Utils,h=g.splitAndRun;return b.mix(j,{fire:function(d,a,b){var c=void 0,e=j.getTargets(d,1),o=e&&e.length,b=b||{};h(a,function(a){var e;g.fillGroupsForEvent(a,b);a=b.type;if((e=f.getCustomEvent(d,a))||o){if(e){if(!e.hasObserver()&&!e.defaultFn&&(e.bubbles&&!o||!e.bubbles))return}else e=new f({currentTarget:d,type:a});a=e.fire(b);!1!==c&&(c=a)}});return c},publish:function(d,a,c){var g;h(a,function(a){g=f.getCustomEvent(d,a,1);b.mix(g,c)});
return d},getCustomEvent:function(d,a,b){return f.getCustomEvent(d,a,b)},addTarget:function(d,a){var c=j.getTargets(d);b.inArray(a,c)||c.push(a);return d},removeTarget:function(d,a){var c=j.getTargets(d),f=b.indexOf(a,c);-1!=f&&c.splice(f,1);return d},getTargets:function(d,a){a||(d["__~ks_bubble_targets"]=d["__~ks_bubble_targets"]||[]);return d["__~ks_bubble_targets"]},on:function(d,a,b,c){g.batchForType(function(a,b,c){b=g.normalizeParam(a,b,c);a=b.type;if(a=f.getCustomEvent(d,a,1))a.on(b)},0,a,
b,c);return d},detach:function(d,a,c,h){g.batchForType(function(a,c,h){var j=g.normalizeParam(a,c,h);(a=j.type)?(a=f.getCustomEvent(d,a,1))&&a.detach(j):(a=f.getCustomEvents(d),b.each(a,function(a){a.detach(j)}))},0,a,c,h);return d}})},{requires:["./api","event/base","./observable"]});
KISSY.add("event/custom",function(b,j,c,f){var g={};b.each(c,function(c,d){g[d]=function(){var a=b.makeArray(arguments);a.unshift(this);return c.apply(null,a)}});c=b.mix({_ObservableCustomEvent:f,Target:g},c);b.mix(j,{Target:g,Custom:c});b.EventTarget=g;return c},{requires:["./base","./custom/api-impl","./custom/observable"]});
