/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jun 7 13:43
*/
KISSY.add("dd/droppable/base",function(i,e,f,g){var d=g.DDM,b=d.PREFIX_CLS;return f.extend({initializer:function(){this.addTarget(d);d._regDrop(this)},getNodeFromTarget:function(a,c,h){var a=this.get("node"),b=a[0];return b==c||b==h?null:a},_active:function(){var a=d.get("activeDrag"),c=this.get("node"),h=this.get("groups"),a=a.get("groups");a:if(!0===a)h=1;else{for(var f in h)if(a[f]){h=1;break a}h=0}h?(d._addValidDrop(this),c&&(c.addClass(b+"drop-active-valid"),d.cacheWH(c))):c&&c.addClass(b+"drop-active-invalid")},
_deActive:function(){var a=this.get("node");a&&a.removeClass(b+"drop-active-valid").removeClass(b+"drop-active-invalid")},__getCustomEvt:function(a){return i.mix({drag:d.get("activeDrag"),drop:this},a)},_handleOut:function(){var a=this.__getCustomEvt();this.get("node").removeClass(b+"drop-over");this.fire("dropexit",a)},_handleEnter:function(a){a=this.__getCustomEvt(a);a.drag._handleEnter(a);this.get("node").addClass(b+"drop-over");this.fire("dropenter",a)},_handleOver:function(a){a=this.__getCustomEvt(a);
a.drag._handleOver(a);this.fire("dropover",a)},_end:function(){var a=this.__getCustomEvt();this.get("node").removeClass(b+"drop-over");this.fire("drophit",a)},destructor:function(){d._unRegDrop(this)}},{name:"Droppable",ATTRS:{node:{setter:function(a){if(a)return e.one(a)}},groups:{value:{}}}})},{requires:["node","rich-base","dd/base"]});
KISSY.add("dd/droppable/delegate",function(i,e,f,g){function d(){var a=this.get("container"),h=[],d=this.get("selector");a.all(d).each(function(a){b.cacheWH(a);h.push(a)});this.__allNodes=h}var b=e.DDM,a=f.extend({initializer:function(){b.on("dragstart",d,this)},getNodeFromTarget:function(a,h,d){var f={left:a.pageX,top:a.pageY},a=this.__allNodes,e=0,g=Number.MAX_VALUE;a&&i.each(a,function(a){var c=a[0];c===d||c===h||(c=b.region(a),b.inRegion(c,f)&&(c=b.area(c),c<g&&(g=c,e=a)))});e&&(this.setInternal("lastNode",
this.get("node")),this.setInternal("node",e));return e},_handleOut:function(){a.superclass._handleOut.apply(this,arguments);this.setInternal("node",0);this.setInternal("lastNode",0)},_handleOver:function(c){var b=this.get("node"),d=a.superclass._handleOut,e=a.superclass._handleOver,f=a.superclass._handleEnter,g=this.get("lastNode");g[0]!==b[0]?(this.setInternal("node",g),d.apply(this,arguments),this.setInternal("node",b),f.call(this,c)):e.call(this,c)},_end:function(){a.superclass._end.apply(this,
arguments);this.setInternal("node",0)}},{ATTRS:{lastNode:{},selector:{},container:{setter:function(a){return g.one(a)}}}});return a},{requires:["dd/base","./base","node"]});KISSY.add("dd/droppable",function(i,e,f,g){f.Delegate=g;e.Droppable=f;e.DroppableDelegate=g;return f},{requires:["dd/base","./droppable/base","./droppable/delegate"]});
